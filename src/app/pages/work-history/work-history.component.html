<!-- src/app/pages/work-history/work-history.component.html -->
<section class="work-history-section">
  <div class="container">
    <div class="section-header" @fadeInUp>
      <h1 class="section-title">
        <i class="icon hardhat-icon"></i>
        Work History
      </h1>
      <p class="section-subtitle">My professional journey and skills acquired along the way</p>
    </div>
    
    <!-- Category filters -->
    <div class="category-filters" @fadeInUp>
      <button 
        *ngFor="let category of categories"
        class="filter-btn"
        [class.active]="selectedCategory === category.id"
        (click)="filterByCategory(category.id)">
        {{category.label}}
      </button>
    </div>
    
    <!-- Work experience timeline -->
    <div class="work-timeline" *ngIf="animationReady">
      <div class="timeline-container" [@staggerFadeIn]="filteredExperiences.length">
        <!-- Current job highlighted section with centered design -->
        <div class="current-job-container" *ngIf="filteredExperiences.length > 0 && filteredExperiences[0].endDate === null">
          <div class="current-job-indicator" @pulseAnimation>
            <div class="pulse-dot"></div>
            <span class="current-job-label">Current Position</span>
            <span class="duration-badge">{{currentJobDuration.years}} year{{currentJobDuration.years !== 1 ? 's' : ''}} {{currentJobDuration.months}} month{{currentJobDuration.months !== 1 ? 's' : ''}}</span>
          </div>
          
          <!-- Featured current job card -->
          <div 
            class="current-job-card"
            [class.expanded]="filteredExperiences[0].isExpanded"
            (click)="toggleExpand(filteredExperiences[0])">
            
            <div class="current-job-header">
              <div class="job-titles">
                <h3 class="job-title">{{filteredExperiences[0].role}}</h3>
                <h4 class="company-name">{{filteredExperiences[0].company}}</h4>
                <div class="job-dates">{{formatDate(filteredExperiences[0].startDate)}} - {{formatDate(filteredExperiences[0].endDate)}}</div>
              </div>
              
              <div class="job-meta">
                <div class="category-badge tech">
                  Technology
                </div>
              </div>
            </div>
            
            <!-- Queue specializations -->
            <div class="queue-specializations">
              <h4 class="section-label">Support Queue Specializations:</h4>
              <div class="queue-badges">
                <span class="queue-badge" *ngFor="let queue of filteredExperiences[0].queues">{{queue}}</span>
              </div>
            </div>
            
            <!-- Certifications -->
            <div class="certifications-section">
              <h4 class="section-label">Certifications:</h4>
              <div class="cert-badges">
                <span class="cert-badge" *ngFor="let cert of filteredExperiences[0].certifications">{{cert}}</span>
              </div>
            </div>
            
            <div class="job-description">
              <p>{{filteredExperiences[0].description}}</p>
            </div>
            
            <button class="expand-toggle large" (click)="toggleExpand(filteredExperiences[0]); $event.stopPropagation()">
              <span>{{filteredExperiences[0].isExpanded ? 'Show Less' : 'Show More'}}</span>
              <svg 
                [@rotateIcon]="filteredExperiences[0].isExpanded ? 'expanded' : 'collapsed'"
                class="expand-icon" 
                width="24" 
                height="24" 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
            </button>
            
            <div 
              class="timeline-card-content expanded-content"
              [@expandCollapse]="filteredExperiences[0].isExpanded ? 'expanded' : 'collapsed'">
              
              <div class="responsibilities-section">
                <h4>Key Responsibilities</h4>
                <ul class="responsibilities-list">
                  <li *ngFor="let responsibility of filteredExperiences[0].responsibilities">
                    {{responsibility}}
                  </li>
                </ul>
              </div>
              
              <!-- Locations section if available -->
              <div class="locations-section" *ngIf="filteredExperiences[0].locations && filteredExperiences[0].locations.length">
                <h4>Location</h4>
                <div class="locations-list">
                  <span class="location-badge" *ngFor="let location of filteredExperiences[0].locations">{{location}}</span>
                </div>
              </div>
              
              <!-- Skills section with loading animation -->
              <div class="skills-section">
                <div class="skills-header">
                  <h4>Technical, Business & Professional Skills</h4>
                  <div class="skill-filter-tags">
                    <button 
                      *ngFor="let skillType of skillTypes"
                      class="skill-filter-tag"
                      [class.active]="selectedSkillType === skillType.id"
                      [ngClass]="'filter-tag-' + skillType.id"
                      (click)="filterBySkillType(skillType.id); $event.stopPropagation()">
                      {{skillType.label.replace(' Skills', '')}}
                    </button>
                  </div>
                  <button class="details-toggle" (click)="toggleDetails(filteredExperiences[0], $event)">
                    {{filteredExperiences[0].isDetailOpen ? 'Hide Details' : 'Show Details'}}
                  </button>
                </div>
                
                <!-- Skills grid with single animation for the entire grid -->
                <div class="skills-grid" [@skillsAnimation]="getFilteredSkills(filteredExperiences[0]).length">
                  <div 
                    *ngFor="let skill of getFilteredSkills(filteredExperiences[0])" 
                    class="skill-card">
                    
                    <div class="skill-header">
                      <h5 class="skill-name">{{skill.name}}</h5>
                      <div class="skill-badges">
                        <span class="skill-level-badge" [ngClass]="getSkillLevelClass(skill.relevance)">
                          {{skill.relevance.charAt(0).toUpperCase() + skill.relevance.slice(1)}}
                        </span>
                        <span class="skill-type-badge" [ngClass]="getSkillCategoryClass(skill.category)">
                          {{skill.category.charAt(0).toUpperCase() + skill.category.slice(1)}}
                        </span>
                      </div>
                    </div>
                    
                    <div class="skill-description" *ngIf="filteredExperiences[0].isDetailOpen">
                      {{skill.description}}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Past jobs in timeline format -->
        <h3 class="past-experience-heading" *ngIf="filteredExperiences.length > 1">Past Experience</h3>
        
        <div 
          *ngFor="let experience of filteredExperiences.slice(1); let i = index" 
          class="timeline-card"
          [class.timeline-card-even]="i % 2 === 1"
          [class.timeline-card-odd]="i % 2 === 0"
          [class.timeline-tech]="experience.category === 'tech'"
          [class.timeline-customer]="experience.category === 'customer-service'"
          [class.timeline-other]="experience.category === 'other'"
          [class.expanded]="experience.isExpanded"
          (click)="toggleExpand(experience)">
          
          <div class="timeline-card-header">
            <div class="job-details">
              <h3 class="job-title">{{experience.role}}</h3>
              <h4 class="company-name">{{experience.company}}</h4>
              <div class="job-duration">
                <span class="dates">{{formatDate(experience.startDate)}} - {{formatDate(experience.endDate)}}</span>
                <span class="duration-label">{{calculateDuration(experience.startDate, experience.endDate)}}</span>
              </div>
            </div>
            
            <div class="relevance-indicator">
              <div class="relevance-meter">
                <div class="relevance-fill" [style.width.%]="experience.relevanceScore"></div>
              </div>
              <span class="relevance-label">Relevance: {{experience.relevanceScore}}%</span>
            </div>
            
            <div class="category-badge" [ngClass]="experience.category">
              {{experience.category === 'tech' ? 'Technology' : 
                experience.category === 'customer-service' ? 'Customer Service' : 'Other'}}
            </div>
            
            <button class="expand-toggle" (click)="toggleExpand(experience); $event.stopPropagation()">
              <svg 
                [@rotateIcon]="experience.isExpanded ? 'expanded' : 'collapsed'"
                class="expand-icon" 
                width="24" 
                height="24" 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
            </button>
          </div>
          
          <div 
            class="timeline-card-content"
            [@expandCollapse]="experience.isExpanded ? 'expanded' : 'collapsed'">
            
            <div class="job-description">
              <p>{{experience.description}}</p>
            </div>
            
            <div class="responsibilities-section">
              <h4>Key Responsibilities</h4>
              <ul class="responsibilities-list">
                <li *ngFor="let responsibility of experience.responsibilities">
                  {{responsibility}}
                </li>
              </ul>
            </div>
            
            <!-- Locations section if available -->
            <div class="locations-section" *ngIf="experience.locations && experience.locations.length">
              <h4>Locations</h4>
              <div class="locations-list">
                <span class="location-badge" *ngFor="let location of experience.locations">{{location}}</span>
              </div>
            </div>
            
            <!-- Skills section with loading animation -->
            <div class="skills-section">
              <div class="skills-header">
                <h4>Skills Developed</h4>
                <div class="skill-filter-tags">
                  <button 
                    *ngFor="let skillType of skillTypes"
                    class="skill-filter-tag"
                    [class.active]="selectedSkillType === skillType.id"
                    [ngClass]="'filter-tag-' + skillType.id"
                    (click)="filterBySkillType(skillType.id); $event.stopPropagation()">
                    {{skillType.label.replace(' Skills', '')}}
                  </button>
                </div>
                <button class="details-toggle" (click)="toggleDetails(experience, $event)">
                  {{experience.isDetailOpen ? 'Hide Details' : 'Show Details'}}
                </button>
              </div>
              
              <!-- Skills grid with single animation for the entire grid -->
              <div class="skills-grid" [@skillsAnimation]="getFilteredSkills(experience).length">
                <div 
                  *ngFor="let skill of getFilteredSkills(experience)" 
                  class="skill-card">
                  
                  <div class="skill-header">
                    <h5 class="skill-name">{{skill.name}}</h5>
                    <div class="skill-badges">
                      <span class="skill-level-badge" [ngClass]="getSkillLevelClass(skill.relevance)">
                        {{skill.relevance.charAt(0).toUpperCase() + skill.relevance.slice(1)}}
                      </span>
                      <span class="skill-type-badge" [ngClass]="getSkillCategoryClass(skill.category)">
                        {{skill.category.charAt(0).toUpperCase() + skill.category.slice(1)}}
                      </span>
                    </div>
                  </div>
                  
                  <div class="skill-description" *ngIf="experience.isDetailOpen">
                    {{skill.description}}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Empty state when no experiences match the filter -->
    <div class="empty-state" *ngIf="filteredExperiences.length === 0" @fadeInUp>
      <div class="empty-icon">
        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
          <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
          <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
        </svg>
      </div>
      <h3>No work experiences in this category</h3>
      <p>Try selecting a different category to view more of my work history</p>
      <button class="btn btn-primary" (click)="filterByCategory('all')">View All Experience</button>
    </div>
  </div>
</section>